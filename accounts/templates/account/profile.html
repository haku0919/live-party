{% extends "account/base.html" %}
{% load static %}

{% block title %}{{ user.nickname }}ë‹˜ì˜ í”„ë¡œí•„{% endblock %}

{% block content %}
<style>
    /* í”„ë¡œí•„ í˜ì´ì§€ ì „ìš© ìŠ¤íƒ€ì¼ (ê¸°ì¡´ ë””ìì¸ ìœ ì§€) */
    .profile-header {
        display: flex;
        align-items: center;
        gap: 24px;
        margin-bottom: 24px;
    }
    
    .avatar-circle {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--brand), var(--brand2));
        color: white;
        font-size: 32px;
        font-weight: 800;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 8px 20px rgba(88,101,242,.3);
        border: 2px solid rgba(255,255,255,0.1);
    }

    .profile-info { flex: 1; }
    
    .profile-name {
        font-size: 26px;
        font-weight: 800;
        margin: 0 0 6px;
        color: var(--text);
    }
    
    .profile-username {
        color: var(--muted);
        font-size: 15px;
        font-weight: 400;
    }

    /* ê²Œì„ íƒœê·¸ ë””ìì¸ */
    .game-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 10px;
    }
    
    .game-tag {
        background: rgba(255,255,255,0.06);
        border: 1px solid var(--border);
        padding: 6px 12px;
        border-radius: 8px;
        font-size: 14px;
        color: var(--text);
        transition: 0.2s;
    }
    
    .game-tag:hover {
        background: rgba(255,255,255,0.1);
        border-color: rgba(255,255,255,0.2);
    }

    /* ë§ˆì´í¬ ìƒíƒœ ë±ƒì§€ */
    .mic-badge {
        display: inline-flex;
        align-items: center;
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 700;
        margin-left: 8px;
        vertical-align: middle;
    }
    .mic-on { background: rgba(46, 204, 113, 0.15); color: #2ecc71; border: 1px solid rgba(46, 204, 113, 0.3); }
    .mic-off { background: rgba(255, 92, 92, 0.15); color: #ff5c5c; border: 1px solid rgba(255, 92, 92, 0.3); }

    @media (max-width: 600px) {
        .profile-header { flex-direction: column; text-align: center; }
        .game-tags { justify-content: center; }
    }
</style>

<section class="hero">
    
    <div class="panel profile-header">
        <div class="avatar-circle">
            {{ user.nickname|slice:":1" }}
        </div>

        <div class="profile-info">
            <h1 class="profile-name">
                {{ user.nickname }}
                {% if user.mic_enabled %}
                    <span class="mic-badge mic-on">ğŸ¤ ë§ˆì´í¬ ON</span>
                {% else %}
                    <span class="mic-badge mic-off">ğŸ”‡ ë§ˆì´í¬ OFF</span>
                {% endif %}
            </h1>
            <span class="profile-username">@{{ user.username }}</span>
        </div>

        <a href="#" class="btn btn-primary">í”„ë¡œí•„ ìˆ˜ì •</a>
    </div>

    <div class="grid">
        <div class="card">
            <p class="card-title">ğŸ‘¤ í”Œë ˆì´ì–´ ì •ë³´</p>
            <div style="margin-top: 16px; display: flex; flex-direction: column; gap: 12px;">
                <div style="display: flex; justify-content: space-between;">
                    <span style="color:var(--muted)">ì„±ë³„</span>
                    <span>{{ user.get_gender_display }}</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span style="color:var(--muted)">ê°€ì…ì¼</span>
                    <span>{{ user.date_joined|date:"Y.m.d" }}</span>
                </div>
            </div>
        </div>

        <div class="card">
            <p class="card-title">ğŸ® ì£¼ í”Œë ˆì´ ê²Œì„</p>
            <div class="game-tags">
                {% for game in user.main_games.all %}
                    <span class="game-tag">{{ game.name }}</span>
                {% empty %}
                    <span style="color:var(--muted); font-size:14px;">ë“±ë¡ëœ ê²Œì„ì´ ì—†ìŠµë‹ˆë‹¤.</span>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="panel">
        <p class="card-title" style="margin-bottom: 15px;">ë§¤ì¹­ íˆìŠ¤í† ë¦¬ (ìµœê·¼ 5ê°œ)</p>
        
        <div style="display: flex; flex-direction: column;">
            {% for match in recent_matches %}
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border);">
                    
                    <div>
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                            <span class="game-tag" style="padding: 2px 8px; font-size: 11px; margin: 0;">{{ match.party.game.name }}</span>
                            <strong style="color: var(--text);">{{ match.party.title }}</strong>
                        </div>
                        <small style="color: var(--muted); font-size: 13px;">{{ match.joined_at|date:"Y.m.d H:i" }} ì°¸ì—¬</small>
                    </div>

                    <div style="display: flex; align-items: center; gap: 10px;">
                        {% if match.party.status == "CLOSED" %}
                            <span style="color: var(--muted); font-size: 12px; font-weight: bold;">ì¢…ë£Œë¨</span>
                        {% else %}
                            <span style="color: #4cd137; font-size: 12px; font-weight: bold;">ì§„í–‰ ì¤‘</span>
                            
                            <a href="{% url 'party_detail' match.party.id %}" 
                               class="btn" 
                               style="padding: 4px 12px; font-size: 12px; min-width: auto; height: auto;">
                               ì…ì¥ ğŸš€
                            </a>
                        {% endif %}
                    </div>
                </div>
            {% empty %}
                <div style="text-align: center; padding: 30px 0;">
                    <p class="card-text" style="margin-bottom: 15px; color: var(--muted);">ì•„ì§ ì°¸ì—¬í•œ íŒŒí‹° ê¸°ë¡ì´ ì—†ì–´ìš”.</p>
                    <a href="{% url 'party_list' %}" class="btn">íŒŒí‹° ì°¾ìœ¼ëŸ¬ ê°€ê¸°</a>
                </div>
            {% endfor %}
        </div>
    </div>

</section>
{% endblock %}