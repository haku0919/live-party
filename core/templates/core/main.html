{% extends "core/base.html" %}

{% block title %}Live Party{% endblock %}

{% block content %}
<style>
  .hero {
    display: grid;
    grid-template-columns: 1.2fr 0.8fr;
    gap: 14px;
    margin-bottom: 18px;
  }

  .hero-main,
  .hero-side { padding: 24px; }

  .hero-main h1 {
    margin: 0;
    font-size: clamp(2rem, 5vw, 3rem);
    line-height: 1.1;
  }

  .hero-main p,
  .hero-side p { color: var(--muted); line-height: 1.6; }

  .cta-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 16px; }

  .feature-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
  }

  .feature-card { padding: 16px; }
  .feature-card h3 { margin: 0 0 8px; }
  .feature-card p { margin: 0; color: var(--muted); font-size: 0.92rem; }

  .popup-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(6px);
    z-index: 110;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .popup-card {
    width: min(92%, 380px);
    border-radius: var(--radius);
    border: 1px solid var(--line);
    background: var(--surface-strong);
    padding: 24px;
    text-align: center;
  }

  @media (max-width: 920px) {
    .hero { grid-template-columns: 1fr; }
    .feature-grid { grid-template-columns: 1fr; }
  }
</style>

{% if user.is_authenticated and user.emailaddress_set.first and not user.emailaddress_set.first.verified %}
<div id="email-popup" class="popup-overlay">
  <div class="popup-card">
    <h2 style="margin:0 0 8px;">이메일 인증이 필요해요</h2>
    <p style="margin:0 0 6px;color:var(--muted);">파티 생성/참여를 안정적으로 이용하려면 이메일 인증을 완료해주세요.</p>
    <p style="margin:0 0 16px;color:var(--muted);font-size:13px;">회원가입 직후 인증 메일이 자동으로 발송됩니다.</p>
    <a href="{% url 'resend-email' %}" class="btn btn-solid" style="display:block;margin-bottom:8px;">인증 메일 보내기</a>
    <button onclick="closePopup()" class="btn btn-ghost" type="button" style="width:100%;">나중에 하기</button>
  </div>
</div>
{% endif %}

<section class="hero">
  <article class="panel hero-main">
    <span class="badge">실시간 팀 매칭</span>
    <h1>지금 필요한 팀원을<br>지금 바로 모으세요.</h1>
    <p>파티 생성, 인원 모집, 채팅, 재참여까지 모두 실시간 반영됩니다. 대기 시간 없이 바로 게임으로 넘어갈 수 있습니다.</p>
    <div class="cta-row">
      <a class="btn btn-solid" href="{% url 'party_list' %}">파티 찾기</a>
      <a class="btn btn-ghost" href="{% url 'party_create' %}">파티 만들기</a>
    </div>
  </article>

  <aside class="panel hero-side">
    <h3 style="margin:0 0 8px;">지금 가능한 것</h3>
    <p>1. 내 조건으로 방 생성</p>
    <p>2. 파티별 비공개 채팅</p>
    <p>3. 방장 권한 자동 위임</p>
    <p>4. 블랙리스트 기반 재입장 차단</p>
  </aside>
</section>

<section class="feature-grid">
  <article class="card feature-card">
    <h3>실시간 로비</h3>
    <p>생성/삭제/인원 변동이 새로고침 없이 즉시 반영됩니다.</p>
  </article>
  <article class="card feature-card">
    <h3>즉시 채팅</h3>
    <p>파티 입장과 동시에 채팅 연결되어 디스코드 공유가 빠릅니다.</p>
  </article>
  <article class="card feature-card">
    <h3>조건 맞춤 모집</h3>
    <p>게임/모드/마이크 여부까지 한 번에 정의해 효율적으로 모읍니다.</p>
  </article>
</section>
{% endblock %}

{% block extra_script %}
<script>
  function closePopup() {
    const popup = document.getElementById('email-popup');
    if (!popup) return;
    popup.style.display = 'none';
  }
</script>
{% endblock %}
